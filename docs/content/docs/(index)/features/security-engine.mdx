---
title: Security Engine
description: Deep dive into the Tharos AST and AI analysis engines.
---

# Security Engine

Tharos uses a hybrid analysis approach to provide both speed and depth. It combines a fast Go-based AST (Abstract Syntax Tree) scanner with high-level AI semantic reasoning.

## AST-Based Scanning
The core of Tharos is a high-performance lexer and parser written in Go. This engine traverses your source code in milliseconds to identify dangerous patterns.

### Detection Capabilities
- **SQL Injection**: Detects direct string interpolation into SQL commands, including support for complex template literals.
- **Hardcoded Secrets**: Uses **entropy analysis** and pattern matching to catch real secrets (e.g., API keys) while ignoring safe variable names.
- **XSS Vulnerabilities**: Flags dangerous DOM sinks like `innerHTML`, `document.write`, and React's `dangerouslySetInnerHTML`.
- **Insecure Routes**: Proactively identifies sensitive administrative or debug endpoints that lack authentication.

## Tharos vs. General Scanners (Semgrep, etc.)

While tools like Semgrep are excellent for general-purpose static analysis and CI/CD linting, Tharos is purpose-built as a **Git Hook Security Scanner**. 

### ðŸŽ¯ Key Differentiators
- **Workflow Gating**: Tharos is designed to run *locally* during the pre-commit phase, acting as the final gate before code is shared.
- **AI-Powered Semantic Understanding**: Unlike regex or simple AST pattern matching, Tharos uses LLMs to understand the *intent* of the code, significantly reducing false positives in complex logic.
- **Self-Healing Integration**: Single-command setup (`tharos init`) that automatically manages your local git hooks.

### ðŸš« Intelligent Commit Blocking
Tharos enforces quality gates directly in your local development workflow. It prevents high-risk code from ever being committed if it detects:
- **Critical Leaks**: Hardcoded secrets, API keys, or private certificates.
- **Injection Risks**: Direct SQLi or XSS patterns in production-bound files.
- **Policy Violations**: Failure to meet compliance standards (OWASP, SOC2).


### ðŸ“Š SARIF Export (Enterprise)
Integrate Tharos into GitHub Advanced Security, GitLab, or any SARIF-compatible tool.

```bash
# Generate a standard SARIF report
tharos analyze . --format sarif > results.sarif
```

## AI Semantic Analysis
While the AST engine catches obvious patterns, the AI engine understands context. By leveraging models like **Gemini 1.5 Pro** and **Llama 3 (via Groq)**, Tharos can:

1. **Calculate Risk Scores**: Goes beyond "True/False" to provide a confidence level and risk probability for every finding.
2. **Contextualize Vulnerabilities**: Distinguishes between a "test" password in a mock file and a real hardcoded credential in a production config.
3. **Generate Fixes**: Provides drop-in code replacements that resolve the security issue while maintaining your project's coding style.

## Magic Fixes
Tharos doesn't just find issues; it fixes them. Our "Magic Fix" technology can automatically rewrite insecure code patterns into safe alternatives.

```bash
# Apply fixes from the CLI
tharos fix src/app/login.ts
```

In the **Playground**, you can click the **MAGIC FIX** button to see this technology in action in real-time.

## Supported Languages
Currently, Tharos provides deep support for:
- **JavaScript/TypeScript** (Full AST analysis)
- **Node.js/Express.js** (Specialized security rules)
- **React** (Component-level security checks)

*Support for Python, Go, and Rust is currently in beta.*
